### Test Borrow and Cancel Logic - No AvailableQuantity Changes

# First login as admin to get token
POST https://localhost:7001/api/auth/login
Content-Type: application/json

{
    "email": "admin@elibrary.com",
    "password": "Admin@123"
}

###

# Login as student to get user token
POST https://localhost:7001/api/auth/login
Content-Type: application/json

{
    "email": "student@example.com", 
    "password": "Student@123"
}

###

# 1. Check available books before borrowing
GET https://localhost:7001/api/book
Authorization: Bearer {{user_token}}
Content-Type: application/json

### 

# 2. Student requests to borrow a book (should NOT decrease AvailableQuantity)
POST https://localhost:7001/api/book/borrow
Authorization: Bearer {{user_token}}
Content-Type: application/json

{
    "bookId": 1,
    "notes": "Test borrow request - should not decrease available quantity"
}

###

# 3. Check available books after request (should be same as before)
GET https://localhost:7001/api/book
Authorization: Bearer {{user_token}}
Content-Type: application/json

###

# 4. Student cancels the borrow request (should NOT increase AvailableQuantity)
PUT https://localhost:7001/api/book/cancel-borrow/{{borrow_record_id}}
Authorization: Bearer {{user_token}}
Content-Type: application/json

###

# 5. Check available books after cancel (should be same as step 3)
GET https://localhost:7001/api/book
Authorization: Bearer {{user_token}}
Content-Type: application/json

###

# 6. Student requests to borrow again
POST https://localhost:7001/api/book/borrow
Authorization: Bearer {{user_token}}
Content-Type: application/json

{
    "bookId": 1,
    "notes": "Test borrow request again"
}

###

# 7. Admin approves the request (should DECREASE AvailableQuantity)
POST https://localhost:7001/api/borrow/approve/{{borrow_record_id}}
Authorization: Bearer {{admin_token}}
Content-Type: application/json

###

# 8. Check available books after approve (should be decreased by 1)
GET https://localhost:7001/api/book
Authorization: Bearer {{user_token}}
Content-Type: application/json

###

# 9. Admin confirms return (should INCREASE AvailableQuantity back)
POST https://localhost:7001/api/borrow/admin/{{borrow_record_id}}/return
Authorization: Bearer {{admin_token}}
Content-Type: application/json

###

# 10. Check available books after return (should be back to original quantity)
GET https://localhost:7001/api/book
Authorization: Bearer {{user_token}}
Content-Type: application/json